---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Jan Rems"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

V projektu bom analiziral delež prebivalstva, na pragu revščine, pred socialnimi transferji in po njih, glede na geografsko poreklo, starost in spol. Prav tako bom analiziral vpliv socialnih transferjev na zmanjšanje tveganja revščine. Podatke bom analiziral za obdobje od 2007 do 2015. Kot kandidateza možne dejavnike bom proučil, indeks BDP na prebivalca upoštevajoč kupno moč, delež BDP-ja namenjenega socialnim transferjem in pa ginijev koeficent.

Tekom naloge bom poizkušal poiskati čim močnejše korelacije med dejavniki in katgorijami ter  ugotovitve vizualiziral. 

V zadnji fazi bom naredil še ...

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Podatke sem uvozil iz spletne strani Eurostat iz več tabel. Večina jih je bila v csv formatu ena (indeks BDP na prebivalca upoštevajoč kupno moč) pa v html. Po preureditvi v tidy-data sem podatke, ki jih bom uporabljal pri analizi, shranil v naslednjih tabelah.

Tabela 1: Deleža socialno ogroženih pred socialnimi transferji (pokojnine so iz transferjev izključene):

* 1. stolpec: Leto (2007-2015), številska spremenljivka
* 2. stolpec: Država, imenska spremenljivka
* 3. stolpec: Spol (Moški, Ženska), imenska spremenljivka
* 4. stolpec: Starost (pod 18 let, od 18 do 64 let, nad 65 let), imenska spremenljivka
* 5. stolpec: Delež (odstotek socialno ogroženih pred transferji), številska spremenljivka

Tabela 2:  Deleža socialno ogroženih po socialnih transferjih:

* 1. stolpec: Leto (2007-2015), številska spremenljivka
* 2. stolpec: DrŽava, imenska spremenljivka
* 3. stolpec: Spol (Moški, Ženska), imenska spremenljivka
* 4. stolpec: Starost (pod 18 let, od 18 do 64 let, nad 65 let), imenska spremenljivka
* 5. stolpec: Delež (odstotek socialno ogroženih po transferjih), številska spremenljivka

Tabela 3: Delež BDP-ja namenjen socialnim transferjem:

* 1. stolpec: Leto (2007-2015), številska spremenljivka
* 2. stolpec: Drzava, imenska spremenljivka
* 3. stolpec: Delež (odstotek BDP-ja namenjen socialnim transferjem), številska spremenljivka

Tabela 4: indeks BDP na prebivalca upoštevajoč kupno moč (kot osnova za indeks je BDP na prebivalca EU28):

* 1. stolpec: Leto (2007-2015), številska spremenljivka
* 2. stolpec: Drzava, imenska spremenljivka
* 3. stolpec: Indeks(indeks BDP na prebivalca upoštevajoč kupno moč), številska spremenljivka

Tabela 5: Ginijev koeficient (merilo neenakomerne porazdelitve dohodka in premoženja):

* 1. stolpec: Leto (2007-2015), številska spremenljivka
* 2. stolpec: Drzava, imenska spremenljivka
* 3. stolpec: Koeficient(ginijev koeficient), številska spremenljivka

Tabela 6: Število prebivalcev države v dotičnem letu

* 1. stolpec: Leto (2007-2015), številska spremenljivka
* 2. stolpec: Drzava, imenska spremenljivka
* 3. stolpec: Populacija (v tisočih), številska spremenljivka



Podatke sem našel na straneh :

- <http://ec.europa.eu/eurostat/web/products-datasets/-/ilc_li10>

- <http://ec.europa.eu/eurostat/web/products-datasets/-/tipslc20>

- <http://ec.europa.eu/eurostat/web/products-datasets/-/tespm050>

- <http://ec.europa.eu/eurostat/web/products-datasets/-/tps00102>


```{r razpredelnice}
kable(head(tabela_pred_transferji), caption = "Delez socialno ogroženih pred transferji")

kable(head(tabela_gini), caption = "Ginijev koeficient")

```

<!-- Slika \ref{fig:histogram} prikazuje porazdelitev števila naselij v občinah. -->

<!-- ```{r histogram, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Histogram števila naselij v občinah'} -->
<!-- ggplot(obcine, aes(x = naselja)) + geom_histogram() + -->
<!--   ggtitle("Pogostost števila naselij") + xlab("Število naselij") + ylab("Število občin") -->
<!-- ``` -->

<!-- *** -->

<!-- # Analiza in vizualizacija podatkov -->

<!-- ```{r vizualizacija, echo=FALSE, message=FALSE} -->
<!-- source("vizualizacija/vizualizacija.r", encoding = "UTF-8") -->
<!-- ``` -->

<!-- Slika \ref{fig:zemljevid} prikazuje povprečno velikost družine za vsako občino. -->

<!-- ```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'} -->
<!-- ggplot() + geom_polygon(data = left_join(zemljevid, povprecja, by = c("OB_UIME" = "obcina")), -->
<!--                         aes(x = long, y = lat, group = group, fill = povprecje)) + -->
<!--   ggtitle("Povprečno število otrok v družini") + xlab("") + ylab("") + -->
<!--   guides(fill = guide_colorbar(title = "Povprečje")) -->
<!-- ``` -->

<!-- *** -->

<!-- # Napredna analiza podatkov -->

<!-- ```{r analiza, echo=FALSE, message=FALSE} -->
<!-- source("analiza/analiza.r", encoding = "UTF-8") -->
<!-- ``` -->

<!-- Slika \ref{fig:graf} prikazuje povezavo med številom naselij in površino občine. -->

<!-- ```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'} -->
<!-- ggplot(inner_join(obcine, data.frame(obcina = names(skupine), -->
<!--                                      skupina = factor(skupine)), by = "obcina") -->
<!-- , aes(x = povrsina, y = naselja, color = skupina, size = prebivalci/1000)) + geom_point() + -->
<!--   ggtitle("Število naselij glede na površino občine") + -->
<!--   xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") + -->
<!--   guides(color = guide_legend(title = "Skupina"), -->
<!--          size = guide_legend(title = "Prebivalci (* 1000)")) -->
<!-- ``` -->

<!-- *** -->

<!-- ```{r shiny, echo = FALSE} -->
<!-- shinyAppDir("shiny", options=list(width="100%", height=600)) -->
<!-- ``` -->
